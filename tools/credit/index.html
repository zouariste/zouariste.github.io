<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Calculateur de crédit immobilier - Calculez vos mensualités, taux d'intérêt et coûts d'investissement total">
    <meta name="author" content="Mohamed Zouari">
    <meta name="keywords" content="crédit immobilier, calculateur, mensualité, prêt, investissement">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Calculateur de Crédit Immobilier">
    <meta property="og:description" content="Calculez vos mensualités et coûts d'investissement">

    <title>Calculateur de Crédit Immobilier</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .navigation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .nav-link {
            padding: 10px 20px;
            background: #f0f0f0;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-block;
        }
        .nav-link:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }
    </style>
    <script>
        function calculMensualite(montant, taux_annuel, duree_annees) {
            if (taux_annuel === 0) {
                return montant / (duree_annees * 12);
            }
            const taux_mensuel = taux_annuel / 12 / 100;
            const nombre_mensualites = duree_annees * 12;
            return montant * taux_mensuel / (1 - Math.pow(1 + taux_mensuel, -nombre_mensualites));
        }

        function updateNotaireRate() {
            const type = document.getElementById("typeImmobilier").value;
            const fraisInput = document.getElementById("fraisNotaire");
            fraisInput.value = (type === "neuf") ? 3 : 8;
        }

        function genererChampsCredits() {
            const nbCredits = parseInt(document.getElementById('nbCredits').value) || 3;
            const container = document.getElementById('credits-container');
            container.innerHTML = '';

            for (let i = 1; i <= nbCredits; i++) {
                container.innerHTML += `
                    <div class="credit-card">
                        <h3>Crédit ${i}</h3>
                        <label>Montant (€) :</label>
                        <input type="number" id="montant${i}" required>
                        <label>Taux (%) :</label>
                        <input type="number" step="0.01" id="taux${i}" required>
                    </div>
                `;
            }
        }

        function calculerMensualite(event) {
            event.preventDefault();
            const nbCredits = parseInt(document.getElementById('nbCredits').value) || 3;
            const apport = parseFloat(document.getElementById('apport').value);
            const duree = parseInt(document.getElementById('duree').value);

            const fraisNotairePct = parseFloat(document.getElementById("fraisNotaire").value);

            let mensualiteTotale = 0;
            let totalPret = 0;
            let resultText = "";

            for (let i = 1; i <= nbCredits; i++) {
                const montant = parseFloat(document.getElementById(`montant${i}`).value);
                const taux = parseFloat(document.getElementById(`taux${i}`).value);
                const mensualite = calculMensualite(montant, taux, duree);

                mensualiteTotale += mensualite;
                totalPret += montant;
                resultText += `Mensualité du crédit ${i} : ${mensualite.toFixed(2)} €\n`;

                if (i === 3) {
                    const interetMensuel = montant * (taux / 100 / 12);
                    const interetMultiple = 6 * interetMensuel;
                    resultText += `6 fois l'intérêt du crédit 3 : ${interetMultiple.toFixed(2)} €\n`;
                }
            }

            const totalInvestissement = apport + totalPret;
            const fraisNotaire = totalInvestissement * (fraisNotairePct / 100);
            const prixBrut = totalInvestissement - fraisNotaire;

            document.getElementById('result').innerText =
                `Mensualité totale : ${mensualiteTotale.toFixed(2)} €\n` +
                resultText +
                `Total des prêts : ${totalPret.toFixed(2)} €\n` +
                `Total de l'investissement (apport + prêts) : ${totalInvestissement.toFixed(2)} €\n` +
                `Frais de notaire (${fraisNotairePct}%) : ${fraisNotaire.toFixed(2)} €\n` +
                `Prix du bien (brut) : ${prixBrut.toFixed(2)} €`;
        }

        function reinitialiserFormulaire() {
            document.querySelector("form").reset();
            document.getElementById("credits-container").innerHTML = "";
            document.getElementById("result").innerText = "";
            genererChampsCredits();
            updateNotaireRate();
        }

        window.onload = genererChampsCredits;
    </script>
</head>
<body>
    <div class="container">
        <nav class="navigation-header" aria-label="Navigation principale">
            <a href="../../index.html" class="nav-link" aria-label="Retour à l'accueil">← Home</a>
            <a href="../index.html" class="nav-link" aria-label="Retour aux outils">← Back to Tools</a>
        </nav>
        <header role="banner">
            <h1>Calculateur de Crédit Immobilier</h1>
        </header>
        <main role="main">
            <form onsubmit="calculerMensualite(event)" aria-label="Formulaire de calcul de crédit">
            <label>Type de bien :</label>
            <select id="typeImmobilier" onchange="updateNotaireRate()">
                <option value="neuf">Immobilier Neuf (3%)</option>
                <option value="ancien">Immobilier Ancien (8%)</option>
            </select>

            <label>Frais de notaire (%) :</label>
            <input type="number" id="fraisNotaire" value="3" step="0.1">

            <label>Nombre de crédits :</label>
            <input type="number" id="nbCredits" value="3" min="1" onchange="genererChampsCredits()">

            <div id="credits-container"></div>

            <label>Apport initial (€) :</label>
            <input type="number" id="apport" required>

            <label>Durée (années) :</label>
            <input type="number" id="duree" required>

            <div class="buttons">
                <button type="submit" aria-label="Calculer les mensualités">Calculer</button>
                <button type="button" onclick="reinitialiserFormulaire()" aria-label="Réinitialiser le formulaire">Réinitialiser</button>
            </div>
        </form>

        <div id="result" role="region" aria-live="polite" aria-label="Résultats du calcul"></div>
        </main>
    </div>
</body>
</html>
